      PROGRAM MAIN
      INTEGER :: STATUS,UNIT,FPIXELS(3),LPIXELS(3),NAXES(3),NPIXELS
      DOUBLE PRECISION, ALLOCATABLE :: ARRAY(:),WORK(:)
      CHARACTER :: FILENAME*80,ARG*255
      STATUS=0
      CALL GETARG(1,FILENAME)
      WRITE(*,'(2A)') 'Input: ',FILENAME
      CALL GETARG(2,ARG)
      READ(ARG,*) FPIXELS(1)
      CALL GETARG(3,ARG)
      READ(ARG,*) FPIXELS(2)
      CALL GETARG(4,ARG)
      READ(ARG,*) FPIXELS(3)
      CALL GETARG(5,ARG)
      READ(ARG,*) LPIXELS(1)
      CALL GETARG(6,ARG)
      READ(ARG,*) LPIXELS(2)
      CALL GETARG(7,ARG)
      READ(ARG,*) LPIXELS(3)
      NAXES=(/LPIXELS(1)-FPIXELS(1)+1,LPIXELS(2)-FPIXELS(2)+1,
     &  LPIXELS(3)-FPIXELS(3)+1/)
      NPIXELS=NAXES(1)*NAXES(2)
      ALLOCATE(ARRAY(NPIXELS))
      ALLOCATE(WORK(NPIXELS))
      CALL AVERAGE(FILENAME,FPIXELS,LPIXELS,ARRAY,WORK)
      CALL GETARG(8,FILENAME)
      CALL WRITEIMAGE(FILENAME,(/1,1,1/),(/NAXES(1),NAXES(2),1/),ARRAY)
      WRITE(*,'(2A)') 'Output: ',FILENAME
      DEALLOCATE(ARRAY)
      DEALLOCATE(WORK)
      STOP
      END PROGRAM
